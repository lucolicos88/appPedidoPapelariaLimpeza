# ‚úÖ V8.0 - ESTRUTURA FINAL ORGANIZADA

## üìã RESUMO DAS MUDAN√áAS

‚úÖ Wrappers consolidados em um √∫nico arquivo
‚úÖ M√≥dulos renomeados sem duplica√ß√µes
‚úÖ CONFIG criado com mapeamento correto de colunas
‚úÖ Arquivos obsoletos removidos

---

## üìÅ ESTRUTURA FINAL DOS M√ìDULOS

### **Camada 00: Utilit√°rios e Configura√ß√£o**
```
00.utils_serialization.js       - Fun√ß√µes de serializa√ß√£o Date‚ÜíISO
00.funcoes_wrapper.js            - 21 wrappers consolidados v8.0
01.config.js                     - CONFIG global com mapeamento de colunas
01.setup.js                      - Setup inicial do sistema
```

### **Camada 02-05: Core Backend**
```
02.autenticacao.js               - Autentica√ß√£o e gest√£o de usu√°rios
03.gerenciamentoProdutos.js      - CRUD de produtos
04.gerenciamentoPedidos.js       - CRUD de pedidos
05.controleEstoque.js            - Gest√£o de estoque
```

**NOTA:** `04.gerenciamentoPedidos.js` precisa ser atualizado com fun√ß√µes de `02.pedidos_v8_ADICOES.js` (j√° deletado)

### **Camada 06-10: Funcionalidades Espec√≠ficas**
```
06.dashboard_consolidado.js      - Dashboard v7.0 com 32 KPIs
07.funcoesAuxiliares.js          - Fun√ß√µes auxiliares gerais
08.interfaceWeb.js               - Interface web doGet()
09.relatorios_avancados.js       - 8 tipos de relat√≥rios v8.0
10.gerenciamentoImagens.js       - Upload Google Drive v8.0
```

### **Camada 99: Testes**
```
99.teste_debug.js                - Testes e debug
```

---

## üóëÔ∏è ARQUIVOS REMOVIDOS

‚úÖ `06.dashboard.js` - Dashboard antigo (obsoleto)
‚úÖ `09.relatorios.js` - Relat√≥rios antigos (obsoleto)
‚úÖ `00.funcoes_wrapper_v8_ADICOES.js` - Consolidado
‚úÖ `02.pedidos_v8_ADICOES.js` - Consolidado
‚úÖ `07.relatorios.js` - Renomeado para 09.relatorios_avancados.js
‚úÖ `08.upload_imagens.js` - Renomeado para 10.gerenciamentoImagens.js

---

## üìä MAPEAMENTO DE COLUNAS (CONFIG)

### **ABA PRODUTOS** (14 colunas)
| √çndice | Coluna | Nome |
|--------|--------|------|
| 1 | A | ID |
| 2 | B | C√≥digo |
| 3 | C | Nome |
| 4 | D | Tipo |
| 5 | E | Categoria |
| 6 | F | Unidade |
| 7 | G | Pre√ßo Unit√°rio |
| 8 | H | Estoque M√≠nimo |
| 9 | I | Ponto de Pedido |
| 10 | J | Fornecedor |
| 11 | K | ImagemURL (antiga - descontinuada) |
| 12 | L | Ativo |
| 13 | M | Data Cadastro |
| **14** | **N** | **Imagem URL (v8.0)** |

### **ABA PEDIDOS** (15 colunas)
| √çndice | Coluna | Nome |
|--------|--------|------|
| 1 | A | ID |
| 2 | B | N√∫mero Pedido |
| 3 | C | Tipo |
| 4 | D | Solicitante Email |
| 5 | E | Solicitante Nome |
| 6 | F | Setor |
| 7 | G | Produtos (JSON) |
| 8 | H | Quantidades (JSON) |
| 9 | I | Valor Total |
| 10 | J | Status |
| 11 | K | Data Solicita√ß√£o |
| 12 | L | Data Compra |
| 13 | M | Data Finaliza√ß√£o |
| 14 | N | Prazo Entrega |
| 15 | O | Observa√ß√µes |

### **ABA ESTOQUE** (8 colunas)
| √çndice | Coluna | Nome |
|--------|--------|------|
| 1 | A | ID |
| 2 | B | Produto ID |
| 3 | C | Produto Nome |
| 4 | D | Quantidade Atual |
| 5 | E | Quantidade Reservada |
| 6 | F | Estoque Dispon√≠vel |
| 7 | G | √öltima Atualiza√ß√£o |
| 8 | H | Respons√°vel |

### **ABA MOVIMENTA√á√ïES ESTOQUE** (11 colunas)
| √çndice | Coluna | Nome |
|--------|--------|------|
| 1 | A | ID |
| 2 | B | Data/Hora |
| 3 | C | Tipo Movimenta√ß√£o |
| 4 | D | Produto ID |
| 5 | E | Produto Nome |
| 6 | F | Quantidade |
| 7 | G | Estoque Anterior |
| 8 | H | Estoque Atual |
| 9 | I | Respons√°vel |
| 10 | J | Observa√ß√µes |
| **11** | **K** | **Pedido ID (v8.0)** |

---

## üîß FUN√á√ïES IMPORTANTES EM CONFIG

### **Fun√ß√µes de Mapeamento:**
```javascript
getIndiceColuna(aba, coluna)     // Retorna √≠ndice de coluna por nome
isStatusValido(status)           // Valida status de pedido
isTipoProdutoValido(tipo)        // Valida tipo de produto
isPerfilValido(perfil)           // Valida perfil de usu√°rio
temPermissao(perfil, funcionalidade) // Verifica permiss√£o de acesso
```

### **Exemplo de Uso:**
```javascript
// Obter √≠ndice da coluna "Imagem URL" da aba Produtos
const indice = getIndiceColuna('Produtos', 'IMAGEM_URL'); // Retorna 14

// Verificar permiss√£o
const podeAcessar = temPermissao('Funcionario', 'Dashboard'); // Retorna false
```

---

## ‚ö†Ô∏è TAREFAS PENDENTES

### **1. Atualizar 04.gerenciamentoPedidos.js**
Adicionar as seguintes fun√ß√µes (que estavam em `02.pedidos_v8_ADICOES.js`):

```javascript
function darBaixaPedido(pedidoId) { ... }
function getPedidoById(pedidoId) { ... }
function buscarProdutos(termo, tipo) { ... }
function getMinhasSolicitacoes(email) { ... }
```

**Arquivo de refer√™ncia:** Ver conte√∫do em `02.pedidos_v8_ADICOES.js` no hist√≥rico do Git

### **2. Atualizar 03.gerenciamentoProdutos.js**
- Adicionar suporte √† coluna "Imagem URL" (√≠ndice 14)
- Usar `CONFIG.COLUNAS_PRODUTOS.IMAGEM_URL` ao inv√©s de n√∫meros hardcoded

### **3. Atualizar 10.gerenciamentoImagens.js**
Na linha ~155, configurar o √≠ndice correto:
```javascript
const colunaImagemUrl = CONFIG.COLUNAS_PRODUTOS.IMAGEM_URL; // 14
```

### **4. Criar Index_v8.html**
- Frontend completo com 8 abas
- Compat√≠vel com CONFIG v8.0
- Controle de permiss√µes por perfil

---

## üìù CHECKLIST DE DEPLOY

### **Backend (Google Apps Script):**
- [ ] Upload de `01.config.js` (NOVO)
- [ ] Substituir `00.funcoes_wrapper.js` pela vers√£o consolidada
- [ ] Renomear `06.dashboard_avancado` ‚Üí `06.dashboard_consolidado`
- [ ] Renomear `07.relatorios` (v8) ‚Üí `09.relatorios_avancados`
- [ ] Renomear `08.upload_imagens` ‚Üí `10.gerenciamentoImagens`
- [ ] Deletar `06.dashboard.js` (antigo)
- [ ] Deletar `09.relatorios.js` (antigo)
- [ ] Atualizar `04.gerenciamentoPedidos.js` com fun√ß√µes v8
- [ ] Atualizar `03.gerenciamentoProdutos.js` para usar CONFIG
- [ ] Atualizar `10.gerenciamentoImagens.js` √≠ndice de coluna

### **Frontend:**
- [ ] Criar `Index_v8.html` completo
- [ ] Testar todas as 8 abas
- [ ] Verificar permiss√µes por perfil

### **Planilha:**
- [x] Coluna "Imagem URL" adicionada em Produtos (coluna N)
- [x] Coluna "Pedido ID" adicionada em Movimenta√ß√µes (coluna K)

---

## üéØ PR√ìXIMOS PASSOS

1. **Consolidar 04.gerenciamentoPedidos.js**
   - Adicionar fun√ß√µes v8.0
   - Usar CONFIG para mapeamento

2. **Atualizar 03.gerenciamentoProdutos.js**
   - Suporte a Imagem URL
   - Usar CONFIG

3. **Criar Index_v8.html**
   - 8 abas funcionais
   - Permiss√µes por perfil
   - Upload de imagens

4. **Testes completos**
   - Cada aba
   - Cada perfil de usu√°rio
   - Upload de imagens
   - Baixa de pedidos
   - Relat√≥rios

---

## üìä ESTAT√çSTICAS FINAIS

| M√©trica | Quantidade |
|---------|------------|
| **M√≥dulos backend** | 12 arquivos |
| **Wrappers consolidados** | 21 fun√ß√µes |
| **Colunas mapeadas** | 48 colunas (4 abas) |
| **Arquivos removidos** | 6 arquivos |
| **Arquivos renomeados** | 3 arquivos |
| **Novos arquivos** | 2 (config + wrappers consolidado) |

---

**Status:** ‚úÖ Reorganiza√ß√£o completa
**Pr√≥ximo:** Criar Index_v8.html
**Vers√£o:** 8.0
**Data:** 03/11/2025
