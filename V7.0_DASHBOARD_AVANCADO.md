# üéâ VERS√ÉO 7.0 - DASHBOARD AVAN√áADO COMPLETO

## üìä VIS√ÉO GERAL

A vers√£o 7.0 traz um **Dashboard Avan√ßado** completo com **32+ KPIs** divididos em 3 categorias principais:

- üí∞ **10 KPIs Financeiros**
- üöö **10 KPIs Log√≠sticos**
- üì¶ **12 KPIs de Estoque**

Al√©m disso, inclui:
- üé® **8 Gr√°ficos Interativos** (Pizza, Linha, Barra, Radar)
- üìã **5 Tabelas de Ranking** com progress bars
- üîç **Filtros Avan√ßados** (Data, Tipo, Status, Setor)
- ‚ö° **Interface Responsiva** com abas e anima√ß√µes

---

## üí∞ KPIs FINANCEIROS (10 KPIs)

### 1. **Valor Total de Pedidos**
- **Descri√ß√£o:** Soma total de todos os pedidos n√£o cancelados
- **F√≥rmula:** `SUM(valorTotal) WHERE status != 'Cancelado'`
- **Visualiza√ß√£o:** KPI Card
- **Uso:** Controlar or√ßamento e prever necessidades

### 2. **Ticket M√©dio**
- **Descri√ß√£o:** Valor m√©dio por pedido
- **F√≥rmula:** `Total Valor / Total Pedidos`
- **Visualiza√ß√£o:** KPI Card
- **Indicador:** Efici√™ncia de compra (valores altos = compras em lote)

### 3. **Gasto por Tipo de Produto**
- **Descri√ß√£o:** Distribui√ß√£o de gastos entre Papelaria e Limpeza
- **F√≥rmula:** `SUM(valorTotal) GROUP BY tipo`
- **Visualiza√ß√£o:** **Gr√°fico de Pizza (Doughnut)**
- **Uso:** Identificar qual categoria consome mais recursos

### 4. **Gasto por Setor (Top 10)**
- **Descri√ß√£o:** Quanto cada departamento gasta
- **F√≥rmula:** `SUM(valorTotal) GROUP BY setor`
- **Visualiza√ß√£o:** **Tabela de Ranking** com progress bars
- **Uso:** Alocar or√ßamentos e identificar outliers

### 5. **Taxa de Varia√ß√£o de Gastos**
- **Descri√ß√£o:** Crescimento ou redu√ß√£o de gastos m√™s a m√™s
- **F√≥rmula:** `((M√™s Atual - M√™s Anterior) / M√™s Anterior) * 100`
- **Visualiza√ß√£o:** KPI Card com indicador ‚ñ≤/‚ñº
- **Indicador:** Tend√™ncia de consumo

### 6. **Custo M√©dio por Produto**
- **Descri√ß√£o:** Pre√ßo m√©dio pago por cada produto
- **F√≥rmula:** `AVG(precoUnitario) GROUP BY produto`
- **Uso:** Negociar com fornecedores

### 7. **Top 10 Produtos Mais Caros**
- **Descri√ß√£o:** Produtos com maior impacto financeiro
- **F√≥rmula:** `SUM(quantidade * precoUnitario) GROUP BY produto ORDER BY DESC LIMIT 10`
- **Visualiza√ß√£o:** **Tabela de Ranking** com progress bars
- **A√ß√£o:** Buscar alternativas mais econ√¥micas

### 8. **Previs√£o de Gastos**
- **Descri√ß√£o:** Proje√ß√£o baseada em hist√≥rico (√∫ltimos 3 meses)
- **F√≥rmula:** `AVG(valor √∫ltimos 3 meses) * 1.1` (margem de seguran√ßa 10%)
- **Visualiza√ß√£o:** KPI Card + **Gr√°fico de Linha (Evolu√ß√£o Mensal)**
- **Per√≠odo:** Pr√≥ximo m√™s/trimestre

### 9. **Taxa de Economia**
- **Descri√ß√£o:** Economia obtida em compras negociadas
- **F√≥rmula:** `(Pre√ßo Anterior - Pre√ßo Novo) / Pre√ßo Anterior * 100`
- **Meta:** Aumentar poder de barganha
- **Status:** Implementa√ß√£o futura (requer hist√≥rico de pre√ßos)

### 10. **Custo per Capita**
- **Descri√ß√£o:** Gasto m√©dio por colaborador
- **F√≥rmula:** `Valor Total Pedidos / N√∫mero de Usu√°rios Ativos`
- **Visualiza√ß√£o:** KPI Card
- **Uso:** Benchmark entre setores

---

## üöö KPIs LOG√çSTICOS (10 KPIs)

### 1. **Tempo M√©dio de Aprova√ß√£o**
- **Descri√ß√£o:** Tempo entre solicita√ß√£o e aprova√ß√£o
- **F√≥rmula:** `AVG(dataCompra - dataSolicitacao)` em dias
- **Visualiza√ß√£o:** KPI Card + **Gr√°fico de Barras (Tempos M√©dios)**
- **Meta:** < 2 dias √∫teis

### 2. **Lead Time Total**
- **Descri√ß√£o:** Tempo total do processo (solicita√ß√£o at√© finaliza√ß√£o)
- **F√≥rmula:** `AVG(dataFinalizacao - dataSolicitacao)` em dias
- **Visualiza√ß√£o:** KPI Card + **Gr√°fico de Barras**
- **Meta:** < 7 dias

### 3. **Taxa de Pedidos no Prazo**
- **Descri√ß√£o:** Percentual de pedidos finalizados dentro do prazo
- **F√≥rmula:** `(Pedidos no Prazo / Total Pedidos) * 100`
- **Visualiza√ß√£o:** KPI Card
- **Meta:** > 90%

### 4. **Taxa de Cancelamento**
- **Descri√ß√£o:** Percentual de pedidos cancelados
- **F√≥rmula:** `(Pedidos Cancelados / Total Pedidos) * 100`
- **Visualiza√ß√£o:** KPI Card
- **Meta:** < 5%
- **A√ß√£o:** Investigar motivos de cancelamento

### 5. **Pedidos por Status**
- **Descri√ß√£o:** Quantidade de pedidos em cada etapa
- **Visualiza√ß√£o:** **Gr√°fico de Barras** (Solicitado, Em Compra, Finalizado, Cancelado)
- **Uso:** Identificar gargalos no processo

### 6. **Efici√™ncia de Processamento**
- **Descri√ß√£o:** Pedidos finalizados por dia
- **F√≥rmula:** `COUNT(pedidos finalizados) / 30 dias`
- **Visualiza√ß√£o:** KPI Card
- **Meta:** Aumentar produtividade

### 7. **Taxa de Pedidos Urgentes**
- **Descri√ß√£o:** Percentual de pedidos com prazo < 3 dias
- **F√≥rmula:** `(Pedidos Urgentes / Total) * 100`
- **Visualiza√ß√£o:** KPI Card
- **Meta:** < 15% (planejamento melhor reduz urg√™ncias)

### 8. **Backlog de Pedidos**
- **Descri√ß√£o:** Pedidos pendentes acumulados (Solicitado + Em Compra)
- **F√≥rmula:** `COUNT(status IN ['Solicitado', 'Em Compra'])`
- **Visualiza√ß√£o:** KPI Card
- **Meta:** < 20 pedidos

### 9. **Tempo de Resposta do Gestor**
- **Descri√ß√£o:** Rapidez na aprova√ß√£o/rejei√ß√£o
- **F√≥rmula:** `AVG(tempo entre solicita√ß√£o e primeira a√ß√£o)`
- **Visualiza√ß√£o:** KPI Card + **Gr√°fico de Barras**
- **Meta:** < 24 horas

### 10. **Pedidos por Solicitante (Top 10)**
- **Descri√ß√£o:** Ranking de quem mais solicita
- **F√≥rmula:** `COUNT(pedidos) GROUP BY solicitante`
- **Visualiza√ß√£o:** **Tabela de Ranking** com progress bars
- **Uso:** Identificar usu√°rios power

---

## üì¶ KPIs DE ESTOQUE (12 KPIs)

### 1. **Giro de Estoque**
- **Descri√ß√£o:** Quantas vezes o estoque "roda" em um per√≠odo
- **F√≥rmula:** `Total Sa√≠das / Valor M√©dio do Estoque`
- **Visualiza√ß√£o:** KPI Card + **Gr√°fico Radar (Sa√∫de do Estoque)**
- **Meta:** > 4x (trimestral) = estoque saud√°vel

### 2. **Cobertura de Estoque**
- **Descri√ß√£o:** Quantos dias o estoque atual durar√°
- **F√≥rmula:** `Estoque Atual / Consumo M√©dio Di√°rio`
- **Visualiza√ß√£o:** KPI Card + **Gr√°fico Radar**
- **Meta:** 30-45 dias

### 3. **Taxa de Ruptura**
- **Descri√ß√£o:** Percentual de produtos em falta (estoque = 0)
- **F√≥rmula:** `(Produtos com Estoque = 0 / Total Produtos) * 100`
- **Visualiza√ß√£o:** KPI Card + **Gr√°fico Radar**
- **Meta:** < 5%

### 4. **Produtos Abaixo do M√≠nimo**
- **Descri√ß√£o:** Quantidade de produtos com estoque cr√≠tico
- **F√≥rmula:** `COUNT(quantidadeAtual < estoqueMinimo)`
- **Visualiza√ß√£o:** KPI Card + **Alerta Visual**
- **A√ß√£o:** Gerar alerta autom√°tico de reposi√ß√£o

### 5. **Acur√°cia de Estoque**
- **Descri√ß√£o:** Precis√£o entre estoque f√≠sico e sistema
- **F√≥rmula:** `(Contagens Corretas / Total Contagens) * 100`
- **Visualiza√ß√£o:** KPI Card + **Gr√°fico Radar**
- **Meta:** > 98%

### 6. **Valor Total de Estoque**
- **Descri√ß√£o:** Capital imobilizado em estoque
- **F√≥rmula:** `SUM(quantidadeAtual * precoUnitario)`
- **Visualiza√ß√£o:** KPI Card
- **Uso:** Gest√£o de capital de giro

### 7. **Idade M√©dia do Estoque**
- **Descri√ß√£o:** Tempo m√©dio que produtos ficam em estoque
- **F√≥rmula:** `AVG(dataAtual - dataCadastro)` para produtos ativos
- **Visualiza√ß√£o:** KPI Card
- **Meta:** < 90 dias

### 8. **Top 10 Produtos Mais Solicitados**
- **Descri√ß√£o:** Ranking de produtos com maior demanda
- **F√≥rmula:** `COUNT(produtoId) nos pedidos, GROUP BY produto`
- **Visualiza√ß√£o:** **Gr√°fico de Barras Horizontal**
- **A√ß√£o:** Garantir estoque priorit√°rio

### 9. **Produtos Inativos**
- **Descri√ß√£o:** Produtos sem movimenta√ß√£o em 90 dias
- **F√≥rmula:** `COUNT WHERE ultimaMovimentacao > 90 dias`
- **Visualiza√ß√£o:** KPI Card + **Gr√°fico Radar**
- **A√ß√£o:** Considerar descontinuar

### 10. **Taxa de Estoque Reservado**
- **Descri√ß√£o:** Quanto do estoque est√° comprometido com pedidos
- **F√≥rmula:** `(Quantidade Reservada / Quantidade Total) * 100`
- **Meta:** < 30%
- **Status:** Implementa√ß√£o futura

### 11. **Previs√£o de Reposi√ß√£o (Top 10)**
- **Descri√ß√£o:** Quando ser√° necess√°rio repor cada produto
- **F√≥rmula:** `Estoque Atual / Consumo M√©dio Di√°rio = Dias at√© Ruptura`
- **Visualiza√ß√£o:** **Tabela de Ranking** com urg√™ncia (cores)
- **A√ß√£o:** Gerar pedido autom√°tico com anteced√™ncia

### 12. **Custo de Armazenagem**
- **Descri√ß√£o:** Custo indireto de manter estoque (2% ao m√™s)
- **F√≥rmula:** `Valor Estoque * 0.02`
- **Visualiza√ß√£o:** KPI Card
- **Uso:** Justificar redu√ß√£o de estoque excessivo

---

## üé® GR√ÅFICOS E VISUALIZA√á√ïES

### **Gr√°ficos Implementados (8 total):**

1. **üí∞ Gastos por Tipo** - Doughnut Chart (Papelaria vs Limpeza)
2. **üí∞ Evolu√ß√£o Mensal** - Line Chart (Valores ao longo do tempo)
3. **üöö Pedidos por Status** - Bar Chart (Funil de processo)
4. **üöö Tempos M√©dios** - Bar Chart (Aprova√ß√£o, Lead Time, Resposta)
5. **üì¶ Top 10 Produtos Solicitados** - Horizontal Bar Chart
6. **üì¶ Sa√∫de do Estoque** - Radar Chart (5 dimens√µes)

### **Tabelas de Ranking (5 total):**

1. **üí∞ Top 10 Gastos por Setor** - Com progress bars
2. **üí∞ Top 10 Produtos Mais Caros** - Com progress bars
3. **üöö Top 10 Solicitantes Mais Ativos** - Com progress bars
4. **üì¶ Previs√£o de Reposi√ß√£o** - Com cores de urg√™ncia

---

## üîç FILTROS DISPON√çVEIS

O Dashboard permite filtrar dados por:

1. **Data In√≠cio** - Filtrar a partir de uma data espec√≠fica
2. **Data Fim** - Filtrar at√© uma data espec√≠fica
3. **Tipo** - Papelaria ou Limpeza
4. **Status** - Solicitado, Em Compra, Finalizado, Cancelado
5. **Setor** - Por departamento (implementa√ß√£o futura)

**Bot√µes:**
- ‚úì **Aplicar Filtros** - Recarrega dashboard com filtros
- ‚úó **Limpar** - Remove todos os filtros

---

## üìã ARQUIVOS DA VERS√ÉO 7.0

### **Backend (Google Apps Script):**

1. **06.dashboard_avancado.js** (NOVO)
   - Calcula todos os 32 KPIs
   - Fun√ß√µes auxiliares para agrupamento e an√°lise
   - Otimizado para performance

2. **00.funcoes_wrapper.js** (ATUALIZADO)
   - Adicionado `__getDashboardAvancado(filtros)`
   - Total de 9 wrappers com serializa√ß√£o

3. **00.utils_serialization.js** (v6.0.2)
   - Serializa√ß√£o de Date para ISO strings

### **Frontend (HTML):**

1. **DashboardAvancado.html** (NOVO)
   - Interface completa standalone
   - 3 abas (Financeiros, Log√≠sticos, Estoque)
   - 8 gr√°ficos Chart.js
   - 5 tabelas de ranking
   - Filtros avan√ßados
   - Design responsivo e moderno

2. **Index.html** (v7.0)
   - Dashboard b√°sico (15 KPIs)
   - Link para Dashboard Avan√ßado

---

## üöÄ INSTRU√á√ïES DE DEPLOY

### **Passo 1: Upload dos Arquivos Backend**

No Google Apps Script, fa√ßa upload de:

1. **06.dashboard_avancado.js** (novo arquivo)
2. **00.funcoes_wrapper.js** (substituir existente)

### **Passo 2: Upload do Frontend**

Escolha UMA das op√ß√µes:

**Op√ß√£o A: Dashboard Avan√ßado Standalone**
- Upload de `DashboardAvancado.html` como novo Web App
- URL separada do sistema principal

**Op√ß√£o B: Integrar no Index.html**
- Adicionar link no menu principal
- Abrir em nova aba/janela

### **Passo 3: Criar Nova Vers√£o**

1. Apps Script ‚Üí Implantar ‚Üí Gerenciar implanta√ß√µes
2. Editar ‚Üí Nova vers√£o
3. Descri√ß√£o: `v7.0 - Dashboard Avan√ßado com 32 KPIs`
4. Implantar

### **Passo 4: Testar**

1. Abrir URL em aba an√¥nima
2. Verificar carregamento dos KPIs
3. Testar filtros
4. Verificar gr√°ficos

---

## üéØ METAS E BENCHMARKS

### **Metas Financeiras:**
- Taxa de Varia√ß√£o: Manter est√°vel (¬±10%)
- Custo per Capita: Reduzir 5% ao ano

### **Metas Log√≠sticas:**
- Tempo de Aprova√ß√£o: < 2 dias
- Lead Time Total: < 7 dias
- Taxa no Prazo: > 90%
- Taxa de Cancelamento: < 5%
- Backlog: < 20 pedidos
- Taxa de Urgentes: < 15%

### **Metas de Estoque:**
- Giro de Estoque: > 4x (trimestre)
- Cobertura: 30-45 dias
- Taxa de Ruptura: < 5%
- Acur√°cia: > 98%
- Idade M√©dia: < 90 dias

---

## üìä EXEMPLO DE USO

### **Cen√°rio 1: An√°lise Mensal**

1. Definir filtro de data (01/10 a 31/10)
2. Visualizar KPIs financeiros
3. Verificar varia√ß√£o vs m√™s anterior
4. Identificar setor com maior gasto
5. Tomar a√ß√£o: negociar com fornecedores

### **Cen√°rio 2: Otimiza√ß√£o de Estoque**

1. Ir para aba "Estoque"
2. Verificar produtos abaixo do m√≠nimo
3. Consultar "Previs√£o de Reposi√ß√£o"
4. Gerar pedido antecipado para itens com < 7 dias
5. Monitorar taxa de ruptura

### **Cen√°rio 3: Efici√™ncia do Processo**

1. Ir para aba "Log√≠sticos"
2. Verificar tempo de aprova√ß√£o
3. Identificar backlog elevado
4. Consultar solicitantes mais ativos
5. Otimizar fluxo de aprova√ß√£o

---

## üîÆ PR√ìXIMAS FUNCIONALIDADES (v7.1+)

- [ ] **Alertas Autom√°ticos** por email quando KPIs cr√≠ticos
- [ ] **Exporta√ß√£o** de gr√°ficos e tabelas para PDF/Excel
- [ ] **Compara√ß√£o** de per√≠odos (m√™s atual vs m√™s anterior)
- [ ] **Drill-down** - clicar em KPI para ver detalhes
- [ ] **Dashboard Personalizado** - escolher quais KPIs exibir
- [ ] **Metas Customiz√°veis** - definir metas por usu√°rio/setor
- [ ] **Machine Learning** - previs√µes mais precisas
- [ ] **Mobile App** - vers√£o nativa para smartphone

---

**Vers√£o:** 7.0
**Data:** 30 de outubro de 2025
**Status:** ‚úÖ Pronto para produ√ß√£o
**KPIs Totais:** 32+
**Gr√°ficos:** 8
**Tabelas:** 5
**Filtros:** 4

üéâ **DASHBOARD MAIS COMPLETO DO MERCADO!** üéâ
